!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(window,function(){return function(r){var o={};function n(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}return n.m=r,n.c=o,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,z,A;z="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,A=function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.1",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},r=0,o=e.length;r<o;r++)t[e.charAt(r)]=r;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0);return[b64chars.charAt(r>>>18),b64chars.charAt(r>>>12&63),2<=t?"=":b64chars.charAt(r>>>6&63),1<=t?"=":b64chars.charAt(63&r)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return fromCharCode(55296+(t>>>10))+fromCharCode(56320+(1023&t));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,r=t%4,o=(0<t?b64tab[e.charAt(0)]<<18:0)|(1<t?b64tab[e.charAt(1)]<<12:0)|(2<t?b64tab[e.charAt(2)]<<6:0)|(3<t?b64tab[e.charAt(3)]:0),n=[fromCharCode(o>>>16),fromCharCode(o>>>8&255),fromCharCode(255&o)];return n.length-=[0,0,2,1][r],n.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(e){return encode(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global.Meteor&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}},module.exports=A(z)}).call(this,__webpack_require__(1))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.r(t);var _={};r.r(_),r.d(_,"getQuery",function(){return a}),r.d(_,"delParam",function(){return i});var p={};r.r(p),r.d(p,"uuid",function(){return c});var o={};r.r(o),r.d(o,"requestInterceptor",function(){return s}),r.d(o,"responseErrorInterceptor",function(){return f});var n={};r.r(n),r.d(n,"beforeEach",function(){return m});var h=r(0);function a(e){var t=window.location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==t||t.length<1?"":t[1]}function i(e){var t=window.location.href,r=window.location.search.substr(1),o=t.substr(0,t.indexOf("?"))||t,n="",a=[];if(""!==r)for(var i=r.split("&"),c=0;c<i.length;c++){var u=i[c].split("=");e.includes(u[0])||a.push(i[c])}return 0<a.length&&(n="?"+a.join("&")),t=o+n}function c(e,t){var r,o,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(t=t||n.length,e)for(r=0;r<e;r++)a[r]=n[0|Math.random()*t];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",r=0;r<36;r++)a[r]||(o=0|16*Math.random(),a[r]=n[19===r?3&o|8:o]);return a.join("")}function u(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var g=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storageProxy=window.sessionStorage,this.defaultLiftTime=2592e6,this.keyCache="SE_OK_PORTAL_KEY_TIMEOUT_MAP"}var t,r,o;return t=e,(r=[{key:"init",value:function(){if(!this.storageProxy)throw new Error("not override storageProxy property")}},{key:"set",value:function(e,t,r){var o=this;if(e="string"!=typeof e?String(e):e,t=this.serializer(t,r),!o.isSupport())return!1;try{o.unEffectiveItem(),this.storageProxy.setItem(e,t);var n=this.storageProxy.getItem(this.keyCache);if(n){var a=n.split(","),i=new Set(a);i.add(e),this.storageProxy.setItem(this.keyCache,Array.from(i).join(","))}else this.storageProxy.setItem(this.keyCache,e)}catch(e){o.isQuotaExceeded(e)}}},{key:"get",value:function(e){e="string"!=typeof e?String(e):e;var t=this.storageProxy.getItem(e);if(t)try{t=this.unSerializer(this.storageProxy.getItem(e))}catch(e){return null}var r=(new Date).getTime();return t&&r<new Date(t.t).getTime()?t.v:(this.remove(e),null)}},{key:"getAll",value:function(){var o=[],n=this;return this.storageProxy||this.storageProxy.length?(Object.keys(this.storageProxy).forEach(function(e){var t={},r=n.unSerializer(n.storageProxy[e]);t.id=e,t.st=r.st,t.v=r.v,o.push(t)}),o):""}},{key:"remove",value:function(e){e="string"!=typeof e?String(e):e,this.storageProxy.removeItem(e)}},{key:"unEffectiveItem",value:function(){var r=(new Date).getTime(),o=this;if(o.storageProxy||o.storageProxy.length){var e=this.storageProxy.getItem(this.keyCache),t=e?e.split(","):[];t&&t.length&&t.forEach(function(e){var t=o.unSerializer(o.storageProxy[e]);t&&r>new Date(t.t).getTime()&&o.remove(e)})}}},{key:"isSupport",value:function(){var e=!1;if(this.storageProxy&&this.storageProxy.setItem){e=!0;var t="__"+Math.round(1e7*Math.random());this.storageProxy.setItem(t,this.keyCache),this.storageProxy.removeItem(t)}return e}},{key:"isQuotaExceeded",value:function(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t}},{key:"serializer",value:function(e,t){var r=(new Date).getTime(),o="number"==typeof(t=t||this.defaultLiftTime)?new Date(r+t):"string"==typeof t?new Date(t):new Date,n={};return n.v=e,n.t=o,n.st=(new Date).getTime(),this.handleJSON(n)}},{key:"unSerializer",value:function(e){return e?JSON.parse(e):""}},{key:"handleJSON",value:function(e){var t="";switch(this.getType(e)){case"boolean":case"function":case"undefined":case"null":break;default:t=JSON.stringify(e)}return t}},{key:"getType",value:function(e){return e instanceof window.Element?"element":{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Data]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}}])&&u(t.prototype,r),o&&u(t,o),e}());function s(e,t,r){var o=r.accessToken,n=r.refreshToken,a=r.authState,i=r.code,c=g.get("se_ok_portal_http_count");if(o&&n)e.url&&-1!==e.url.indexOf(t.tokenUri)?e.headers.Authorization="Basic "+h.Base64.encode(t.client_id+":"+t.clientSecret):e.headers.Authorization="Bearer "+o;else{var u=a||_.getQuery("state");if((i||_.getQuery("code"))&&u)e.headers.Authorization="Basic "+h.Base64.encode(t.client_id+":"+t.clientSecret);else if(!c){g.set("se_ok_portal_http_count",1);var s=_.delParam(["code","state"]),f=t.client_id,l=encodeURIComponent(s),d=p.uuid(6,16);window.location.href=t.authorizeUri+"?client_id="+f+"&redirect_uri="+l+"&response_type=code&scope=read&state="+d}}return e}function f(e,t,r,o,n){var a=o.refreshToken,i=o.authState,c=o.code,u=g.get("se_ok_portal_res_count");if(e&&e.response)switch(e.response.status){case 401:a&&!u&&(g.set("se_ok_portal_res_count",1),r.post(t.tokenUri+"?grant_type=refresh_token&refresh_token="+encodeURIComponent(a)+"&scope=read","",{headers:{Authorization:"Basic "+h.Base64.encode(t.client_id+":"+t.clientSecret)}}).then(function(e){var t=e&&e.data&&e.data.access_token,r=e&&e.data&&e.data.refresh_token;n(t,r,i,c)}))}}var l;function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y={namespaced:!0,state:{code:null,authState:null,accessToken:null,refreshToken:null},mutations:(d(l={},"setState",function(e,t){e.authState=t}),d(l,"setCode",function(e,t){e.code=t}),d(l,"setAccessToken",function(e,t){e.accessToken=t}),d(l,"setRefreshToken",function(e,t){e.refreshToken=t}),d(l,"setAuthState",function(e,t){var r=t.accessToken,o=t.refreshToken,n=t.authState,a=t.code;e.authState=n,e.code=a,e.accessToken=r,e.refreshToken=o}),l)};function b(e,t,r,o,n,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(o,n)}function m(e,t,r,o,n,a){return v.apply(this,arguments)}function v(){var c;return c=regeneratorRuntime.mark(function e(t,r,o,n,a,i){var c,u,s,f,l,d,h,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=_.getQuery("state"),u=_.getQuery("code"),s=g.get("se_ok_portal_count"),f=_.delParam(["code","state"]),c&&u)return e.prev=5,e.next=8,a.post(n.tokenUri+"?code="+u+"&state="+c+"&grant_type=authorization_code&client_id="+n.client_id+"&redirect_uri="+encodeURIComponent(f));e.next=23;break;case 8:l=e.sent,d=l&&l.data&&l.data.access_token,h=l&&l.data&&l.data.refresh_token,y.state.accessToken=d,y.state.refreshToken=h,y.state.authState=c,y.state.code=u,i(d,h,c,u),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),s&&0<parseInt(s)?o():(g.set("se_ok_portal_count",1),b={client_id:n.client_id,redirect_uri:encodeURIComponent(f),state:p.uuid(6,16)},window.location.href=n.authorizeUri+"?client_id="+b.client_id+"&redirect_uri="+b.redirect_uri+"&response_type=code&scope=read&state="+b.state);case 21:e.next=24;break;case 23:o();case 24:case"end":return e.stop()}},e,null,[[5,18]])}),(v=function(){var e=this,i=arguments;return new Promise(function(t,r){var o=c.apply(e,i);function n(e){b(o,t,r,n,a,"next",e)}function a(e){b(o,t,r,n,a,"throw",e)}n(void 0)})}).apply(this,arguments)}r.d(t,"authStore",function(){return y}),r.d(t,"authHttp",function(){return o}),r.d(t,"authRoute",function(){return n})}])});
//# sourceMappingURL=index.c8722738f2fab0d94c53.map